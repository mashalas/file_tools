# fresh_files_processor
## Обработчик свежих файлов
Для новых файлов в заданном каталоге (каталогах) выполнить команды операционной системы.

Все параметры задаются в конфигурационном файле. Скрипту как в качестве аргументов командной строки передаётся один или несколько конфигурационных файлов. Пример конфигурационного файла:
```
dir=./files
mask=*.txt
processed=processed.log
dir=another_files
sort_by=mtime
sort_reverse=true

<commands>
  md5sum ${longname} > ${longname}.md5
  echo size: ${filesize} >> ${longname}
</commands>
```
При передаче этого конфигурационного файла будут выполнены следующие действия:
1. Просканировать каталоги "./files" и "another_files" на предмет наличия в них файлов с расширением txt
2. Полученный из обоих каталогов список файлов отсортировать по дате модификации (sort_by=mtime) в обратном порядке (sort_reverse=true). 
3. Из файла processed.log будет получен список файлов, которые уже обрабатывались ранее. Для обработанных ранее файлов никаких действий не выполняется. Если параметр processed конфигурационного файла не содержит имени файла или отсутствует в конфигурационном файле - действия будут выполняться кажый раз для всех найденных файлов.
4. Выполнить команды операционной системы перечисленные в блоке между <commands> и </commands>

Возможные критерии сортировки:
   * ctime = время создания файла
   * mtime = время изменения файлу
   * atime = время доступа к файлу
   * shortname = короткое имя файла без имени каталога
   * longname = длинное имя файла с именем каталога
   * filesize = размер файла
   * filetime = время изменения файла в формате %Y-%m-%d %H:%M:%S
 
Команды могут содержать переменные вида ${name}, где name - имя переменной и вместо name будет подставляться значение этой переменной. Имена переменных такие же, как критерии сортировки

Если параметр processed указан и содержит не пустое значение, то в файл с именем указанным в параметре processed будут записаны "длинные имена" файлов, для которых сейчас применялись команды, чтобы в следующий раз эти файлы не обрабатывать .
